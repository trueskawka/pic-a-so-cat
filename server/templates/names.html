{% extends "base.html" %}

{% block title %}
  word, word, woooords!
{% endblock title %}

{% block content %}
  <div style="margin-bottom: 20px">
    <h4>I found some names! I can give you more names.</h4>
    <a href="/static/names_log" download><button>wanna grab them?</button></a>
    <button id="getname">generate a name</button>
  </div>
  <div id="names">
  {% for word in log_data %}
    {% if word != "" %}
      {{ word }} ->
    {% endif %}
  {% endfor %}
  </div>
{% endblock content %}

{% block scripts %}
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
  <script type="text/javascript" charset="utf-8">
    'use strict';
    
    document.addEventListener('DOMContentLoaded', function() {
      const socket = io.connect('http://' + document.domain + ':' + location.port + '/names');
      const btn    = document.getElementById('getname');
      const theDiv = document.getElementById('names');

      socket.on('connect', function() {
        console.log('are you still in?')
      });

      btn.onclick = function() {
        console.log('click!');
        socket.emit('getname', { data: 'gimme a name!' });
      }

      socket.on('name', function(msg) {
        console.log(msg.data);
        theDiv.innerHTML += msg.data + ' -> '; 
      });
    });
  </script>
{% endblock scripts %}